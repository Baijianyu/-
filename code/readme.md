**1.** **概述**

**1.1** **标识**

文档名称：程序设计基础训练实验7—程序设计说明书文档编号：Lab7-001

**1.2.** **范围**

本文档适用于《程序设计基础训练》课程，为课程实验7环节的交付物。文档用于描述程序设计基础训练课程中实验7所编写程序的设计方案。文档阅读对象为本课程授课教师及本课堂同学。

**2.** **程序设计需求**

2.1功能需求

根据《程序设计基础训练》课程实验7要求，待编写的程序需要实现以下功能：

 

1）设计程序读取随机生成的数据文件，如下图

其中文件的第一行用于存储需要响应的记录条数，如图2.1中，表示数据文件中

总共存储了9条数据记录；

从文件第二行开始，逐条存储数据记录文件，数据记录文件是一个三元组<元素1,元素2,元素3>每个元素为一个int值，元素与元素之间用“,”（英文逗号）进行分隔；三个数据分别表示“用户所处楼层”“用户要到达的楼层”以及“用户发出这条请求的时间点”

2）设计实现以下功能： 

能够以外部程序的方式对“生成文件.exe”程序进行调用，用exe程序生成数据记录文件，用实验7程序读取并显示数据记录文件内容；

对电梯响应用户请求过程的仿真功能。

电梯仿真功能以每隔1秒执行的功能函数方式实现

在每一时刻的电梯仿真中，将时刻序号，当前时刻电梯状态和下一时刻电梯状态打印到屏幕上。

用户请求信息数组：用于存放从数据记录文件中读出的所有用户请求数据。

待响应指令队列：当当前仿真时刻等于用户发出请求的时间点时，将用户请求加入待响应指令队列。

电梯当前服务指令队列：当电梯响应一条用户请求时，将用户请求从待响应队列中取出，加入电梯当前服务指令队列。

3）程序设计时请遵守以下要求：  

实验7主函数要求由一条语句实现，实验7的所有功能均实现在run( )函数内；

以多件工程的方式组织实验7程序的开发。

**3.** **程序详细设计**

**3.1** **功能详细设计**

1）外部程序调用功能：外部程序调用功能主要实现对编译好的exe程序进行调用，这里为了方便，我将写成了一个cpp文件 文件名“生成文件.cpp”默认路径为相对路径，因为这样便于调试。

2）排序功能：每一种储存方式中都会将储存的数据按照每行第三个数据由小到大  排序并打印在屏幕上。

3）显示功能：将电梯工作状态，电梯上的人数，电梯所在楼层显示在屏幕上。

4）延时功能：每条语句间隔时间1s出现在屏幕上。

5）响应功能：可同时响应多名用户的指令并可以智能的选择先后顺序。

**3.2** **程序与外部程序协同设计**

1）生成文件从cpp文件与实验7程序存放于同一级目录下；

2）使用system函数打开“生成文件.exe”生成记录文件； 

**3.3** **程序工程文件组织设计**

程序源文件设计

| 模块名称             | 文件名称                                                     | 文件说明                                       |
| -------------------- | ------------------------------------------------------------ | ---------------------------------------------- |
| 主模块               | 实验7.cpp                                                    | 程序入口文件，存放整个工程的main函数           |
| main.cpp             | 程序主控文件，存放run函数以及其他配套的子函数，存放程序主体部分 |                                                |
| mian.h               | 主控文件的头文件                                             |                                                |
| 结构体及常量声明模块 | data.h                                                       | 存放所有结构体声明                             |
| 数据显示模块         | view.h                                                       | 存放将数据显示在屏幕上的函数的声明             |
| view.cpp             | 存放将数据显示在屏幕的函数                                   |                                                |
| 数据加载模块         | loadfile.h                                                   | 存放数据加载函数的头文件                       |
| loadfile.cpp         | 存放数据加载函数并将加载数据显示在屏幕上                     |                                                |
| 数据初始化模块       | conf.h                                                       | 存放数据初始化函数的头文件                     |
| conf.cpp             | 存放数据初始化函数                                           |                                                |
| 电梯响应模块         | check.h                                                      | 存放检查电梯是否可以响应其他指令的函数的头文件 |
| check.cpp            | 存放检查电梯是够可以响应其他指令的函数以及其他一些函数的声明和结构体声明 |                                                |
| response.h           | 存放删除结点和将数据移动的相关函数声明                       |                                                |
| response.cpp         | 存放删除结点和将数据移动的相关函数                           |                                                |
| 改变运行状态模块     | change.h                                                     | 存放改变电梯状态函数头文件                     |
| change.cpp           | 存放改变电梯状态函数                                         |                                                |
| 头文件声明模块       | stdafx.h                                                     | 存放一些环境自带的头文件声明                   |
| stdafx.cpp           | 引用所需的头文件                                             |                                                |